<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interactive Word Search</title>
<style>
:root { --bg-start:#CDE8FF; --bg-end:#E8F5FF; --card:#FFFFFF; --text:#2F3B3B; }
body { margin:0; font-family:"Nunito","Segoe UI",Roboto,Arial,sans-serif; background:linear-gradient(180deg,var(--bg-start),var(--bg-end)); color:var(--text); display:flex; justify-content:center; padding:20px; }
.app { display:grid; grid-template-columns:300px 1fr 320px; gap:20px; background:var(--card); padding:20px; border-radius:16px; box-shadow:0 10px 30px rgba(30,50,60,0.08); }
.word-list-panel { display:flex; flex-direction:column; align-items:stretch; background:#E0F0FF; padding:16px; border-radius:14px; box-shadow:inset 0 0 10px rgba(80,100,120,0.08); }
.word-list-panel h2 { margin:0 0 12px; font-size:20px; text-align:center; }
.word-item { display:flex; align-items:center; padding:8px 10px; margin:6px 0; border-radius:6px; font-weight:700; background:linear-gradient(180deg,#fff,#f5faff); border:1px solid rgba(120,130,150,0.15); }
.word-item .dot { width:14px; height:14px; border-radius:50%; margin-right:8px; flex-shrink:0; }
.word-item.found { text-decoration:line-through; opacity:0.8; color:#333; }
.grid-wrap { display:flex; flex-direction:column; align-items:center; position:relative; }
.grid { display:inline-grid; gap:6px; padding:12px; background:linear-gradient(180deg,#fff,#fbfdff); border-radius:14px; border:1px solid rgba(140,160,170,0.06); position:relative; z-index:1; }
.cell { width:44px; height:44px; display:flex; align-items:center; justify-content:center; font-weight:800; font-size:20px; border-radius:10px; cursor:pointer; background:linear-gradient(180deg,#FFF,#F8FBFF); border:1px solid rgba(130,150,160,0.06); user-select:none; transition:background 0.2s, transform 0.6s; position:relative; }
.cell.found { color:#000; }
.cell.spin { animation:spin 0.6s ease-in-out; }
@keyframes spin { from{transform:rotate(0deg);} to{transform:rotate(360deg);} }
.controls { display:flex; flex-direction:column; }
.controls label { margin-top:8px; font-weight:600; }
.controls textarea { width:100%; height:120px; border-radius:8px; padding:8px; resize:vertical; }
.controls select, .controls button { margin-top:6px; width:100%; padding:8px; border-radius:8px; }
.start-btn { background:linear-gradient(180deg,#DDF7E9,#C6F1E2); border:none; font-weight:700; }
@media (max-width:980px){ .app { grid-template-columns:1fr; } }
</style>
</head>
<body>
<div class="app">
  <div class="word-list-panel">
    <h2>Word List</h2>
    <div id="wordList"></div>
  </div>
  <div class="grid-wrap">
    <div style="font-size:18px;font-weight:800;margin-bottom:12px;">Interactive Word Search</div>
    <div id="grid" class="grid"></div>
  </div>
  <div class="controls">
    <h2>Word Lists</h2>
    <label>Saved Lists:</label>
    <select id="savedLists"><option value="">--Select--</option></select>
    <button id="deleteListBtn" style="background:#FFC1C1;">Delete Selected</button>
    <label>Enter Words (one per line):</label>
    <textarea id="wordsInput" placeholder="apple&#10;pond&#10;star"></textarea>
    <label>Grid Size:</label>
    <select id="gridSize"><option value="8">8×8</option><option value="10" selected>10×10</option><option value="12">12×12</option></select>
    <button class="start-btn" id="generate">Generate Puzzle</button>
    <button class="start-btn" id="resetBtn" style="margin-top:8px;">Reset</button>
  </div>
</div>

<script>
const gridEl=document.getElementById('grid'),
      wordListEl=document.getElementById('wordList'),
      wordsInput=document.getElementById('wordsInput'),
      gridSizeSel=document.getElementById('gridSize'),
      generateBtn=document.getElementById('generate'),
      resetBtn=document.getElementById('resetBtn'),
      savedListsSel=document.getElementById('savedLists'),
      deleteListBtn=document.getElementById('deleteListBtn');

let gridSize=parseInt(gridSizeSel.value), board=[], placedWords=[], spinInterval=null;
const pastelColors=["#CC3366","#3366CC","#33CC99","#FF9933","#9933CC","#FF6633","#33CCB2","#CC3399"];

/* Audio */
let audioCtx;
function playBeep(){if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); const o=audioCtx.createOscillator(); o.type='sine'; o.frequency.setValueAtTime(800,audioCtx.currentTime); const g=audioCtx.createGain(); g.gain.setValueAtTime(0.1,audioCtx.currentTime); o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.1);}
function playScale(){if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)(); const notes=[523,587,659,698,784]; notes.forEach((f,i)=>{const o=audioCtx.createOscillator(); o.type='sine'; o.frequency.setValueAtTime(f,audioCtx.currentTime+i*0.15); const g=audioCtx.createGain(); g.gain.setValueAtTime(0.12,audioCtx.currentTime+i*0.15); o.connect(g); g.connect(audioCtx.destination); o.start(audioCtx.currentTime+i*0.15); o.stop(audioCtx.currentTime+i*0.15+0.15);});}

/* Spin effect */
function startRandomLetterSpin(){if(spinInterval) clearInterval(spinInterval); spinInterval=setInterval(()=>{const cells=Array.from(gridEl.querySelectorAll('.cell')); if(cells.length===0) return; const randCell=cells[Math.floor(Math.random()*cells.length)]; randCell.classList.add('spin'); setTimeout(()=>randCell.classList.remove('spin'),600);},300);}

/* LocalStorage */
function saveWordList(name, arr){const lists=JSON.parse(localStorage.getItem('wordLists')||'{}'); lists[name]=arr; localStorage.setItem('wordLists',JSON.stringify(lists)); populateSavedLists();}
function populateSavedLists(){savedListsSel.innerHTML='<option value="">--Select--</option>'; const lists=JSON.parse(localStorage.getItem('wordLists')||'{}'); for(const n in lists){const opt=document.createElement('option'); opt.value=n; opt.textContent=n; savedListsSel.appendChild(opt);}}
deleteListBtn.addEventListener('click',()=>{const n=savedListsSel.value; if(!n) return; if(confirm(`Delete "${n}"?`)){const lists=JSON.parse(localStorage.getItem('wordLists')||'{}'); delete lists[n]; localStorage.setItem('wordLists',JSON.stringify(lists)); populateSavedLists(); wordsInput.value='';}});
savedListsSel.addEventListener('change',()=>{const n=savedListsSel.value; const lists=JSON.parse(localStorage.getItem('wordLists')||'{}'); wordsInput.value=lists[n]?lists[n].join('\n'):'';});

/* Grid functions */
function buildGrid(words){
  board=Array.from({length:gridSize},()=>Array.from({length:gridSize},()=>'')); placedWords=[]; if(spinInterval){ clearInterval(spinInterval); spinInterval=null;}
  words.forEach((w,i)=>{
    let placed=false, tries=0;
    const color=pastelColors[i%pastelColors.length];
    while(!placed && tries<500){
      tries++;
      const dir=Math.random()<0.5?'H':'V';
      const r=Math.floor(Math.random()*(gridSize-(dir==='V'?w.length:0)));
      const c=Math.floor(Math.random()*(gridSize-(dir==='H'?w.length:0)));
      let conflict=false;
      for(let j=0;j<w.length;j++){const rr=r+(dir==='V'?j:0), cc=c+(dir==='H'?j:0); if(board[rr][cc]){conflict=true; break;}}
      if(conflict) continue;
      for(let j=0;j<w.length;j++){const rr=r+(dir==='V'?j:0), cc=c+(dir==='H'?j:0); board[rr][cc]=w[j].toUpperCase();}
      placedWords.push({word:w.toUpperCase(), positions:Array.from({length:w.length},(_,k)=>({r:r+(dir==='V'?k:0),c:c+(dir==='H'?k:0)})), found:false, active:false, color:color, progress:0});
      placed=true;
    }
  });
  for(let r=0;r<gridSize;r++) for(let c=0;c<gridSize;c++) if(!board[r][c]) board[r][c]=String.fromCharCode(65+Math.floor(Math.random()*26));
  renderGrid(); renderWordList();
}

function renderGrid(){
  gridEl.innerHTML=''; gridEl.style.gridTemplateColumns=`repeat(${gridSize},44px)`;
  for(let r=0;r<gridSize;r++) for(let c=0;c<gridSize;c++){
    const cell=document.createElement('div'); cell.className='cell'; cell.textContent=board[r][c]; cell.dataset.r=r; cell.dataset.c=c;
    cell.addEventListener('click',()=>onCellClick(r,c,cell)); gridEl.appendChild(cell);
  }
}

function renderWordList(){wordListEl.innerHTML=''; placedWords.forEach(w=>{const item=document.createElement('div'); item.className='word-item'; const dot=document.createElement('span'); dot.className='dot'; dot.style.background=w.color; item.appendChild(dot); const txt=document.createElement('span'); txt.textContent=w.word; item.appendChild(txt); wordListEl.appendChild(item);});}

function onCellClick(r,c,el){
  playBeep();
  const pw=placedWords.find(p=>!p.found && p.positions.some(pos=>pos.r===r && pos.c===c));
  if(!pw) return;
  // Activate only when first letter is clicked
  if(!pw.active){ if(pw.positions[0].r===r && pw.positions[0].c===c) pw.active=true; else return;}
  // Only allow correct next letter in order
  const nextPos=pw.positions[pw.progress];
  if(r!==nextPos.r || c!==nextPos.c) return;
  el.style.background=pw.color+'AA'; pw.progress++;
  if(pw.progress===pw.positions.length){
    pw.found=true;
    const item=Array.from(wordListEl.children).find(n=>n.textContent.includes(pw.word));
    if(item) item.classList.add('found');
    playScale();
    if(placedWords.every(p=>p.found)) celebrateEndGame();
  }
}

function celebrateEndGame(){
  startRandomLetterSpin();
  if('speechSynthesis' in window){const utter=new SpeechSynthesisUtterance("YOU DID IT!"); utter.rate=0.5; utter.pitch=1; utter.onend=()=>{playScale();}; window.speechSynthesis.speak(utter);} else {playScale();}
}

/* Buttons */
generateBtn.addEventListener('click',()=>{
  gridSize=parseInt(gridSizeSel.value);
  const raw=wordsInput.value.trim();
  if(!raw) return alert('Enter at least one word');
  const words=raw.split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
  const selected=savedListsSel.value;
  if(!selected){ const name=prompt("Name this list to save (optional):"); if(name) saveWordList(name,words);}
  buildGrid(words);
});

resetBtn.addEventListener('click',()=>{
  board=[]; placedWords=[]; spinInterval && clearInterval(spinInterval);
  gridEl.innerHTML=''; wordListEl.innerHTML=''; wordsInput.value='';
});

populateSavedLists();
gridEl.innerHTML='';
</script>
</body>
</html>
